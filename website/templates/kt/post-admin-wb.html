{% extends 'base-admin.html' %}
{% block title %}Карточка товара{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-lg-12 grid-margin stretch-card">
            <div class="card">
                <div class="card-body">
                    <div class="chartjs-size-monitor">
                        <div class="chartjs-size-monitor-expand">
                            <div class=""></div>
                        </div>
                        <div class="chartjs-size-monitor-shrink">
                            <div class=""></div>
                        </div>
                    </div>

                    {% if post.post_status == 'на модерации' %}
                        <p><span class="badge badge-warning">{{ post.post_status }}</span></p>
                    {% elif post.post_status == 'отклонено' %}
                        <p><span class="badge badge-danger">{{ post.post_status }}</span></p>
                    {% elif post.post_status == 'опубликовано' %}
                        <p><span class="badge badge-success">{{ post.post_status }}</span></p>
                    {% elif post.post_status == 'заархивировано' %}
                        <p><span class="badge badge-black">{{ post.post_status }}</span></p>
                    {% else %}
                        <p>{{ post.post_status }}</p>
                    {% endif %}

                    {% if wbpost.articul_wb %}
                        <a href="https://www.wildberries.ru/catalog/{{ wbpost.articul_wb }}/detail.aspx" class="mdi mdi-link-variant">Страница карточки товара на WB</a>
                    {% endif %}
                    <br>
                    <div class="col-md-9">
                        Наименование: {{ post.title }}
                        <br>
                        Описание: {{ post.content }}
                        <br><br>

                        <div class="row">
                            {% for url in image_urls %}
                                <div class="col-sm-6 col-md-3">
                                    <img src="{{ url_for('static', filename=url) }}" class="img-thumbnail" style="width: 100%; max-width: 250px;">
                                </div>
                            {% endfor %}
                        </div>

                        {% if post.post_status != 'опубликовано' %}
                            <form action="/posts/{{ post.post_id }}/approve" method="post" onsubmit="return confirm('Подтвердите публикацию карточки товара на WB')">
                                <button type="submit" class="btn btn-gradient-success btn-fw">Опубликовать</button>
                            </form>
                        {% endif %}

                        <br>

                        <form action="/posts/{{ post.post_id }}/reject" method="post">
                            <button type="submit" class="btn btn-danger">Отклонить</button>
                        </form>

                    </div>

                </div>
            </div>
        </div>
    </div>

    <table class="table table-striped">
        <thead class="thead-dark">
            <tr>
                <th class="mdi mdi-message-text">История изменений</th>
                <th>Дата</th>
            </tr>
        </thead>
        <tbody>
            {% for comment in comments %}
                <tr>
                    <td>{{ comment.content }}</td>
                    <td>{{ comment.comment_date }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <form method="post" enctype="multipart/form-data" action="/add_comment">
        <label for="comment_text">Добавить комментарий</label><br>
        <textarea id="comment_text" name="comment_text" placeholder="Оставьте комментарий для автора для пояснений в случае отклонения карточки товара" rows="4" cols="50"></textarea><br><br>
        <input type="hidden" name="post_id" value="{{ post.post_id }}">
        <input type="submit" name="add_comment" value="Добавить комментарий">
    </form>

{% endblock %}
